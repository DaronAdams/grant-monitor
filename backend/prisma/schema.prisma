// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

model User {
  id              Int     @id @default(autoincrement())
  email           String  @unique
  password        String
  confirmPassword String
  name            String?
}

enum StatusType {
  Recieved
  Aprroved
  Completed
}

model Grant {
  id             Int        @id @default(autoincrement())
  grantIndex     Int        @unique
  createdAt      DateTime   @default(now())
  updatedAt      DateTime   @updatedAt
  fund           String
  organization   String
  account        String
  userId         Int
  Status         StatusType
  startDate      DateTime
  endDate        DateTime
  notes          String?
  yearlyAmount   Float
  NCEAppDate     DateTime
  costShareIndex Float
  cayuse         String
  sponsor        String
  totalAmount    Float

  transactions       Transaction?
  payments           Payment?
  grantBudgetItems   GrantBudgetItem?
  grantEmployeeEfort GrantEmployeeEffort?
  PI                 PI?
}

model Transaction {
  id      Int      @id @default(autoincrement())
  amount  Float
  date    DateTime
  Grant   Grant    @relation(fields: [grantId], references: [id])
  grantId Int      @unique

  @@index([grantId])
}

model Employee {
  id                  Int                   @id @default(autoincrement())
  uID                 String
  balance             Float
  firstName           String
  rate                Float
  effort              Float
  startDate           DateTime
  endDate             DateTime
  lastName            String
  payments            Payment[]
  grantEmployeeEffort GrantEmployeeEffort[]
}

model PI {
  id                 Int    @id @default(autoincrement())
  uNumber            String
  firstName          String
  lastName           String
  summerEffort       Float
  months             Float
  costShareEffort    Float
  academicYearEffort Float
  credit             Float
  Grant              Grant  @relation(fields: [grantId], references: [id])
  grantId            Int    @unique

  @@index([grantId])
}

model GrantBudgetItem {
  id         Int    @id @default(autoincrement())
  name       String
  balance    Float
  grantId    Int    @unique
  commitment String
  spent      Float
  account    String
  Grant      Grant  @relation(fields: [grantId], references: [id])

  @@index([grantId])
}

model Payment {
  id            Int      @id @default(autoincrement())
  type          String
  earnings_code Int
  Hours         Float
  Rate          Float
  Frequency     String
  Date          DateTime
  Grant         Grant    @relation(fields: [grantId], references: [id])
  grantId       Int      @unique
  Employee      Employee @relation(fields: [employeeId], references: [id])
  employeeId    Int

  @@index([employeeId])
  @@index([grantId])
}

model GrantEmployeeEffort {
  id         Int      @id @default(autoincrement())
  effort     Float
  Grant      Grant    @relation(fields: [grantId], references: [id])
  grantId    Int      @unique
  Employee   Employee @relation(fields: [employeeId], references: [id])
  employeeId Int

  @@index([grantId])
  @@index([employeeId])
}
